# Первые шаги

## Предпосылки

- Установленная игра "Бесконечное Лето".
- Текстовый редактор. Я рекомендую использовать [Visual Studio Code](https://code.visualstudio.com/) (+ [Ren'Py](https://marketplace.visualstudio.com/items?itemName=LuqueDaniel.languague-renpy)) или [Notepad++](https://notepad-plus-plus.org/), [Atom](https://atom.io/), как альтернативу

## Создание мода

Для начало нужно создать файл с расширением `.rpy`. Затем открыть его в текстовом редакторе, и следовать далее по руководству.

### Написание кода

Стиль и синтаксис Ren'Py похож на Python. Если знакомы с ним, то проблем возникнуть не должно.

Файлы состоят из блоков и команд в блоках, например:

```
<Блок>:
    <Команды>

<Блок>
```

::: warning
Команды в блоках должны везде иметь одинаковый отступ. Будь то 2 или 4 пробела.
В большинстве случаев **рекомендуется использовать 4 пробела**.
:::

В большинстве случаев в редакторе кода будет по-умолчанию выставлено значение отступов, поэтому рекомендуется использовать `TAB` для отступов.

### Объявление мода

::: danger
Шаги, приведенные ниже крайне важны. Без них мод не будет виден в списке модов в игре.
:::

Для того чтобы игра поняла, что файл (в котором строчки будут написаны) является модом, нужно написать следующее:

```renpy
init:
    $ mods["my_mod"] = "Мой мод"
```

Разберем более детально пример выше:

1. `my_mod` - название начального лейбла мода. При запуске мода, всегда первым начинает запускаться этот лейбл, указанный внутри командых скобок. Не будет виден пользователю. Должен быть уникальным, иначе возможны конфликты с модификациями, имеющими лейблы с таким же названием. **Можно использовать только латиницу!**
2. `Мой мод` - название мода, которое будет отображаться в списке модов. **Допускается использование кириллицы**.

Теперь, для того, чтобы игра поняла, где начинается мод, нужно добавить начальный лейбл:

```renpy{4-5}
init:
    $ mods["my_mod"] = "Мой мод"

label my_mod:
    "Реплика"
    # Далее будут идти команды
```

В коде выше:

1. Была объявлена метка (`label`), имя которой **обязательно должно соответствовать имени мода, указанного в квадратных скобках**. В нашем случае - `my_mod`.

## Написание сценария

Далее, в метке `my_mod` можно начинать писать сценарий. В нем используется специальный синтаксис Ren'Py, который мы разберем далее.

### Метки

Использование меток позволяет облегчить процесс создания мода, путем разделения сценария на части.

::: danger
Имена меток должны быть уникальными, дабы избежать конфликтов.
Рекомендуется использовать названия меток, начиная с названия мода, например, `my_mod_day1`.
:::

Общий синтаксис метки выглядит так:

```renpy
label <Название>:
    <Команды>
```

#### Переходы между лейблами

Есть два вида переходов:

1. **Прыжок (jump)**

```renpy
label my_mod_day1:
    "..."
    jump my_mod_day2 # Прижок на my_mod_day2

label my_mod_day2:
    "..."
```

В данном случае команды после "прыжка" будут пропущены игрой, например, фраза "действия после прыжка" из примера ниже не будет выведена на экран игрока. Любые другие команды, которые были написаны после прыжка также не сработают.

```renpy{4}
label my_mod_day1:
    "..."
    jump my_mod_day2
    "действия после прыжка"

label my_mod_day2:
    "..."
```

2. **Вызов (call)**

В этом случае, фраза из примера выше будет выведена на экран, после завершения действий из метки `my_mod_day2`.

```renpy{3}
label my_mod_day1:
    "..."
    call my_mod_day2 # Вызов второго лейбла
    "действия после прыжка"

label my_mod_day2:
    "..."
```

Закончить блок можно командой `return`. После неё мод будет завершен и будет показано главное меню игры.

В примере с `call`, если добавить `return`, то действия после "вызова" выполняться не будут, так как блок завершится в метке `my_mod_day2`.

```renpy{8}
label my_mod_day1:
    "..."
    call my_mod_day2
    "действия после прыжка"

label my_mod_day2:
    "..."
    return
```

### Реплики

Реплики персонажей имеют следующий общий вид: `<ID персонажа> "<Реплика>"`, где:

1. `ID персонажа` - название переменной, которой он был объявлен.
2. `Реплика` - текст, который будет говорить персонаж.

Список персонажей и их переменные представлены в таблице ниже:

<CharactersTable />

В примере ниже представлен пример реплик Мику и Ульяны, имена которых ещё не известны:

```renpy
label my_mod:
    mip "Привет, ты меня ещё не знаешь, но это я — Мику!"
    mip "В данный момент я у тебя отображаюсь как 'Пионерка'."
    usg "Привет, а я — Ульянка! Но у тебя я написана как \"Девочка\"."
```

В первом случае, имя пионера или пионерки будет сменено на "Пионер/Пионерка", сохраняя свой цвет. Во втором же случае имя персонажа будет сменено на "Девочка", сохраняя свой цвет.

#### Оформление текста

Примеры текстовых тегов:

1. **alpha**

Текстовый тег `alpha` отображает текст, расположенный между самим тегом и его закрывающим тегом, с указанной непрозрачностью. Непрозрачность должна иметь значение между 0.0 и 1.0, что соответствует полной прозрачности и полной непрозрачности, соответственно. Если значение начинается с префикса `+` (добавить на) или `-` (убавить на), непрозрачность будет изменена на указанное число, а не полностью заменена. Если значение начинается с префикса `*` (умножить на), непрозрачность будет умножена на это число.

```renpy
"{alpha=0.1}Этот текст едва читаем!{/alpha}"
"{alpha=-0.1}Этот текст на 10 процентов прозрачнее, чем текст по умолчанию.{/alpha}"
"{alpha=*0.5}Этот текст наполовину такой же непрозрачный, как и по умолчанию.{/alpha}"
```

2. **b** (bold)

Тег жирного шрифта выводит текст, расположенный между самим тегом и его закрывающим тегом, жирным шрифтом.

```renpy
"Пример {b}текста, выделенного жирным шрифтом{/b}."
```

3. **color**

Текстовый тег `color` отображает текст, расположенный между самим тегом и его закрывающим тегом, в указанном цвете. Цвет должен быть в формате #rgb, #rgba, #rrggbb или #rrggbbaa.

```renpy
"{color=#f00}Красный{/color}, {color=#00ff00}Зелёный{/color}, {color=#0000ffff}Синий{/color}"
```

4. **i** (italic)

Тег курсива отображает текст, расположенный между самим тегом и его закрывающим тегом, курсивом.

```renpy
mt "Добро пожаловать в {i}СОЛ «Совёнок»!{/i}."
```

5. **s** (strikethrough)

Тег зачеркивания проводит черту через текст, расположенный между тегом и его закрывающим тегом.

```renpy
mi "Я очень надеюсь, что {s}тебе понравилось{/s}."
```

6. **u** (underline)

Тег подчеркивания подчеркивает текст, расположенный между самим тегом и его закрывающим тегом.

```renpy
mi "Рада видеть {u}тебя{/u}!"
```

7. **w** (wait)

Тег ожидание – самозакрывающийся тег, который ждёт, пока читатель нажмёт на кнопку для продолжения. Если для тега задан аргумент в форме числа,то ожидание автоматически заканчивается, когда заданные секунды проходят.

```renpy
un "Я{w} очень{w=1.0} рада!"
```

Полный список текстовых тегов можно найти внутри [соответствующей статьи в документации Ren'Py](<http://ru.renpypedia.shoutwiki.com/wiki/%D0%A2%D0%B5%D0%BA%D1%81%D1%82_(Text)>)

## Фоны

Общий синтаксис для вывода фона: `scene <Название фона>`

Например:

```renpy
scene bg bus_stop # Покажет нам автобусную остановку из времени Семена
scene bg int_bus # Внутри автобуса, привезшего нас в "Совенок"
scene bg ext_bus_night # Снаружи этого же автобуса, но уже ночью
```

Список всех фонов пока можно найти [здесь](https://drive.google.com/file/d/0B7BOgg028z7pWk9IbC1ZTlJDODQ/view).

## Спрайты

Вызывается спрайт с помощью: `show <Имя спрайта>`

Обычно спрайты состоят из слов, разделённых пробелом: `<имя персонажа> <эмоция> <одежда>`

::: tip
В оригинальной игре имя персонажа совпадает с ID говорящего из предыдущего раздела этого руководства
:::

Например:

```renpy
show dv angry pioneer # Злая Алиса
show un cry sport # Смущенная Лена в спортивной форме
```

Список всех спрайтов пока можно найти [здесь](https://drive.google.com/file/d/0B7BOgg028z7pbksxbFM3X1NOcXM/view).

::: warning
Если персонаж уже на экране, то повторное использование show будет менять эмоцию и/или одежду
:::

Для того, чтобы убрать персонажа воспользуйтесь: `hide <Имя персонажа>`

::: tip
Если вы хотите вслед за этим сменить декорации, то прописывать hide для каждого персонажа не обязательно, команда scene сама их уберет
:::

### Действия со спрайтами

#### Позиционирование

При простом использовании `show <Спрайт>` он будет появляться просто по центру, это можно исправить добавив в конец `at <Позиция>`: `show <Спрайт> at <Позиция>`.

Всего в игре 7 позиций где может находиться спрайт:

- `fleft`
- `left`
- `cleft`
- `center`
- `cright`
- `right`
- `fright`

![Пример расположения спрайтов](/images/example_sprites_positioning.jpg)

На скриншоте выше были использованы следующие команды:

```renpy
scene bg ext_bus_night

show dv angry pioneer2 at left
show un smile pioneer at right
show mi cry_smile pioneer at cleft
show sl serious pioneer at cright
show mt rage panama pioneer at center
```

Так же можно показать персонажа ближе / дальше. Для этого можно воспользоваться атрибутом `close` / `far`.

![Пример использования атрибутов close / far](/images/example_sprites_distances.jpg)

На скриншоте выше как раз были использованны эти атрибуты. Команды:

```renpy
scene bg ext_bus_night

show dv angry pioneer2 far at left
show un smile pioneer far at right
show mi cry_smile pioneer at cleft
show sl serious pioneer at cright
show mt rage panama pioneer close at center
```
